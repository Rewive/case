<html>
<header>
    <title>Case</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
</header>

<body>
    <div class="info-box">
        <a class="info noselect" onclick="info()" id="i">i</a>
    </div>
    <p class="eficensy noselect" id="info">Это кейс класса case-1 и из него тебе может выпасть:<br> 1. Обычный предмет с шансом 45% <br> 2. Необычный предмет с шансом 25% <br> 3. Редкий предмет с шансом 15% <br> 4. Супер редкий предмет с шансом 10% <br> 5. Эпический предмет с шансом 4.8% <br> 6.Легендарный предмет с шансом 0.2% </p>
    <div class="box">
        <div class="case">
            <a class="case-button noselect" id="case-1">Открой свой первый кейс!</a>
            <a class="case-button-open noselect" onclick="case_open()">Открыть</a>
        </div>
    </div>
    <p class="debug noselect" id="debug">Debug:<br>Common ---- none<br>Uncommon ---- none<br>Rare ---- none<br>Super rare ---- none<br>Epic ---- none<br>Legendar ---- none</p>
</body>

<script>
    let n_click = 0;
    let co = 0; un = 0; ra = 0; sr = 0; ep = 0; le = 0; cop = 0; unp = 0; rap = 0; srp = 0; epp = 0; lep = 0; sum = 0;

    document.getElementById("info").style.display = "none";

    function info() {
        if (n_click == 0) {
            document.getElementById("info").style.display = "flex";
            document.getElementById("i").innerText = "X";
            n_click = 1
        }
        else {
            document.getElementById("info").style.display = "none";
            document.getElementById("i").innerText = "i";
            n_click = 0
        }
    }

    function rand(min, max) {
        ming = Math.ceil(min);
        maxg = Math.floor(max);
        let rand = Math.floor(Math.random() * (maxg - ming)) + ming;
        return rand;
    }

    function case_open() {
        ef = rand(1, 1000)
        if (ef >= 1 && ef <= 250) { // 1 кейс-лут "необычный" 25%
            status = "uncommon"
        }
        else if (ef >= 250 && ef <= 400) { // 2 кейс-лут "редкий" 15%
            status = "rare"
        }
        else if (ef >= 401 && ef <= 500) { // 3 кейс-лут "супер редкий" 10%
            status = "super rare"
        }
        else if (ef >= 501 && ef <= 950) { // 4 кейс-лут "обычный" 45%
            status = "common"
        }
        else if (ef >= 951 && ef <= 998) { // 5 кейс-лут "эпический" 5%
            status = "epic"
        }
        else if (ef >= 999 && ef <= 1000) { // 6 кейс-лут "легендарный" 0.1%
            status = "legendar"
        }
        ef = ""
        result(status);
    }

    function procents(){
        sum = un + co + ra + sr + ep + le;
        unp = (un * 100 / sum).toFixed(2)// 1
        cop = (co * 100 / sum).toFixed(2)// 2
        rap = (ra * 100 / sum).toFixed(2)// 3
        srp = (sr * 100 / sum).toFixed(2)// 4
        epp = (ep * 100 / sum).toFixed(2)// 5
        lep = (le * 100 / sum).toFixed(2)// 6
        document.getElementById("debug").innerText = "Debug:\nCommon ---- " + co + " ---- " + cop + "%\nUncommon ---- " + un + " ---- " + unp + "%\nRare ---- " + ra + " ---- " + rap + "%\nSuper rare ---- " + sr + " ---- " + srp + "%\nEpic ---- " + ep + " ---- " + epp + "%\nLegendar ---- " + le + " ---- " + lep + "%"
    }

    function result(main_status) {
        status = main_status
        document.getElementById("case-1").style.background = "none";
        if (status == 'uncommon') {
            document.getElementById("case-1").style.backgroundColor = "orange";
            ru_status = "необычный"
            un += 1
            procents();
        }
        else if (status == 'common') {
            document.getElementById("case-1").style.backgroundColor = "red";
            ru_status = "обычный"
            co += 1
            procents();
        }
        else if (status == 'rare') {
            document.getElementById("case-1").style.backgroundColor = "blue";
            ru_status = "редкий"
            ra += 1
            procents();
        }
        else if (status == 'super rare') {
            document.getElementById("case-1").style.backgroundColor = "green";
            ru_status = "супер редкий"
            sr += 1
            procents();
        }
        else if (status == 'epic') {
            document.getElementById("case-1").style.backgroundColor = "violet";
            ru_status = "эпический"
            ep += 1
            procents();
        }
        else if (status == 'legendar') {
            document.getElementById("case-1").style.background = "linear-gradient(135deg, #ff05d9, #2e5bff, #33ffb8, #3cff6d, #2e5bff, #ff05d9)";
            document.getElementById("case-1").style.backgroundSize = "500% 500%";
            document.getElementById("case-1").style.animation = "legendar 20s ease infinite";
            ru_status = "легендарный"
            le += 1
            procents();
        }
        res = "Тебе выпал " + ru_status + " предмет!"
        document.getElementById("case-1").innerText = res;
    }

</script>

</html>